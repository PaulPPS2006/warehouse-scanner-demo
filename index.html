<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>HairHouse Inventory Scanner</title>
  <script src="https://cdn.jsdelivr.net/npm/@zxing/library@0.20.0"></script>
  <style>
    body { font-family: sans-serif; background:#0b0f14; color:white; padding:20px; }
    button { margin:5px; padding:10px 20px; border:none; border-radius:8px; }
    #video { width:100%; max-width:480px; border:2px solid #555; border-radius:8px; }
  </style>
</head>
<body>
  <h1>HairHouse Inventory Scanner</h1>
  <p>Scan barcodes to add/remove items directly to your HairHouseData sheet.</p>

  <select id="mode">
    <option value="ADD">Add</option>
    <option value="REMOVE">Remove</option>
  </select>
  <input id="shelf" placeholder="Shelf (e.g., A1)">
  <button onclick="startScanner()">Start Scanner</button>
  <p id="status"></p>
  <video id="video" playsinline></video>

  <script>
  const API = "YOUR_WEB_APP_URL_HERE";     // from Google Apps Script deploy
  const TOKEN = "super-secret-token";       // same as in Apps Script

  let codeReader;

  async function startScanner(){
    try {
      codeReader = new ZXing.BrowserMultiFormatReader();
      const devices = await ZXing.BrowserCodeReader.listVideoInputDevices();
      const back = devices.find(d => /back|rear|environment/i.test(d.label)) || devices[0];
      document.getElementById('status').innerText = 'Camera starting...';
      codeReader.decodeFromVideoDevice(back.deviceId, 'video', (result, err)=>{
        if(result){
          handleScan(result.getText());
        }
      });
    } catch(e){
      document.getElementById('status').innerText = 'Error starting camera: ' + e;
    }
  }

  async function handleScan(barcode){
    const shelf = document.getElementById('shelf').value.trim().toUpperCase();
    const action = document.getElementById('mode').value;
    if(!barcode) return;
    document.getElementById('status').innerText = `Scanned: ${barcode}`;
    const res = await fetch(API, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ token: TOKEN, action, shelf, barcode })
    });
    const data = await res.json();
    if(data.ok) document.getElementById('status').innerText = `${action} OK: ${barcode}`;
    else document.getElementById('status').innerText = 'Error: ' + (data.error || 'unknown');
  }
  </script>
</body>
</html>




